
<p *ngIf="!books"><em>Loading...</em></p>

<mat-spinner *ngIf="!books"></mat-spinner>

<mat-accordion>

  <mat-expansion-panel [expanded]="showAllBooksPanelOpenState"
                       (opened)="showAllBooksPanelOpenState = true"
                       (closed)="showAllBooksPanelOpenState = false">

    <mat-expansion-panel-header>
      <mat-panel-title>
        Books Read
      </mat-panel-title>
      <mat-panel-description>
        <div *ngIf="!selectedBookToDisplay">
          Select Book to Display, Update or Delete
        </div>
        <div *ngIf="selectedBookToDisplay">
          <span><b>Selected Book: </b> {{selectedBook.author}} {{selectedBook.title}}</span>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <div class="mat-elevation-z8" *ngIf="books">

      <table class="noborders-table">
        <tr class="noborders">
          <td class="noborders">
            <mat-form-field appearance="fill">
              <input matInput (keyup)="applyBooksFilter($event.target.value)"
                     placeholder="Filter">
            </mat-form-field>
          </td>
          <td class="noborders">
            <mat-paginator #booksTablePaginator
                           [length]="5"
                           [pageSize]="4"
                           [pageSizeOptions]="[5, 10, 20]"
                           showFirstLastButtons>
            </mat-paginator>
          </td>
        </tr>
      </table>

      <mat-table #table [dataSource]="booksDataSource"
                 #booksTableSort="matSort"
                 matSortActive="date"
                 matSortDisableClear
                 matSortDirection="asc"
                 matSort>

        <ng-container matColumnDef="author">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Author </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.author}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="title">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Title </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.title}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="date">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Date </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.date | date : "d MMMM yyyy"}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="pages">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Pages </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.pages}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="nationality">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Nationality </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.nationality}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="originalLanguage">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Language </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.originalLanguage}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="format">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Format </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.format}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="cover">
          <mat-header-cell *matHeaderCellDef> Cover </mat-header-cell>
          <mat-cell *matCellDef="let element"><img src="{{element.imageUrl}}" class="aspectshrink"/></mat-cell>
        </ng-container>

        <ng-container matColumnDef="note">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Notes </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div class="scrollable">{{element.note}}</div>
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="booksDisplayedColumns"></mat-header-row>

        <mat-row *matRowDef="let row; columns: booksDisplayedColumns"
                 (click)="onBooksRowClicked(row)"></mat-row>

      </mat-table>

    </div>

  </mat-expansion-panel>

</mat-accordion>

<div *ngIf="selectedBookToDisplay">

  
        
  <div style="margin: 15px;">
    <label>Date Time Read:</label>
    <input [formControl]="selectedBookReadTime"
           [owlDateTimeTrigger]="dtPicker" [owlDateTime]="dtPicker">
    <owl-date-time #dtPicker></owl-date-time>
  </div>

  <app-book-detail [bookSelected]="selectedBook">

  </app-book-detail>

</div>
